{"ast":null,"code":"import{supabase}from'../config/supabase';// Obtener todos los productos\nexport const getAllProducts=async function(){let filters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};try{let query=supabase.from('products').select('*').eq('is_active',true);// Filtro por categoría\nif(filters.category&&filters.category!=='todos'){query=query.eq('category',filters.category);}// Filtro por rango de precio\nif(filters.minPrice!==undefined){query=query.gte('price',filters.minPrice);}if(filters.maxPrice!==undefined){query=query.lte('price',filters.maxPrice);}// Búsqueda por texto\nif(filters.search){query=query.or(\"name.ilike.%\".concat(filters.search,\"%,description.ilike.%\").concat(filters.search,\"%\"));}// Ordenamiento\nif(filters.sortBy){switch(filters.sortBy){case'precio-asc':query=query.order('price',{ascending:true});break;case'precio-desc':query=query.order('price',{ascending:false});break;case'nombre':query=query.order('name',{ascending:true});break;case'rating':query=query.order('rating',{ascending:false});break;case'ventas':query=query.order('sales',{ascending:false});break;default:query=query.order('created_at',{ascending:false});}}else{query=query.order('created_at',{ascending:false});}const{data,error}=await query;if(error)throw error;return{data,error:null};}catch(error){return{data:null,error:error.message};}};// Obtener un producto por ID\nexport const getProductById=async id=>{try{const{data,error}=await supabase.from('products').select('*').eq('id',id).single();if(error)throw error;return{data,error:null};}catch(error){return{data:null,error:error.message};}};// Obtener productos por categoría\nexport const getProductsByCategory=async category=>{try{const{data,error}=await supabase.from('products').select('*').eq('category',category).eq('is_active',true).order('created_at',{ascending:false});if(error)throw error;return{data,error:null};}catch(error){return{data:null,error:error.message};}};// Buscar productos\nexport const searchProducts=async searchTerm=>{try{const{data,error}=await supabase.from('products').select('*').or(\"name.ilike.%\".concat(searchTerm,\"%,description.ilike.%\").concat(searchTerm,\"%,category.ilike.%\").concat(searchTerm,\"%\")).eq('is_active',true).limit(10);if(error)throw error;return{data,error:null};}catch(error){return{data:null,error:error.message};}};// Obtener productos destacados\nexport const getFeaturedProducts=async function(){let limit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:4;try{const{data,error}=await supabase.from('products').select('*').eq('is_active',true).order('rating',{ascending:false}).limit(limit);if(error)throw error;return{data,error:null};}catch(error){return{data:null,error:error.message};}};// Obtener productos más vendidos\nexport const getBestSellers=async function(){let limit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:4;try{const{data,error}=await supabase.from('products').select('*').eq('is_active',true).order('sales',{ascending:false}).limit(limit);if(error)throw error;return{data,error:null};}catch(error){return{data:null,error:error.message};}};// Actualizar stock de producto\nexport const updateProductStock=async(productId,quantity)=>{try{const{data:product}=await getProductById(productId);if(!product)throw new Error('Producto no encontrado');const newStock=product.stock-quantity;if(newStock<0)throw new Error('Stock insuficiente');const{data,error}=await supabase.from('products').update({stock:newStock}).eq('id',productId).select().single();if(error)throw error;return{data,error:null};}catch(error){return{data:null,error:error.message};}};// Incrementar contador de ventas\nexport const incrementProductSales=async function(productId){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;try{const{data:product}=await getProductById(productId);if(!product)throw new Error('Producto no encontrado');const{data,error}=await supabase.from('products').update({sales:product.sales+quantity}).eq('id',productId).select().single();if(error)throw error;return{data,error:null};}catch(error){return{data:null,error:error.message};}};","map":{"version":3,"names":["supabase","getAllProducts","filters","arguments","length","undefined","query","from","select","eq","category","minPrice","gte","maxPrice","lte","search","or","concat","sortBy","order","ascending","data","error","message","getProductById","id","single","getProductsByCategory","searchProducts","searchTerm","limit","getFeaturedProducts","getBestSellers","updateProductStock","productId","quantity","product","Error","newStock","stock","update","incrementProductSales","sales"],"sources":["C:/Users/Usuario/OneDrive/Desktop/proyecto/chinasaqra-demo/src/services/productService.js"],"sourcesContent":["import { supabase } from '../config/supabase';\n\n// Obtener todos los productos\nexport const getAllProducts = async (filters = {}) => {\n  try {\n    let query = supabase\n      .from('products')\n      .select('*')\n      .eq('is_active', true);\n\n    // Filtro por categoría\n    if (filters.category && filters.category !== 'todos') {\n      query = query.eq('category', filters.category);\n    }\n\n    // Filtro por rango de precio\n    if (filters.minPrice !== undefined) {\n      query = query.gte('price', filters.minPrice);\n    }\n    if (filters.maxPrice !== undefined) {\n      query = query.lte('price', filters.maxPrice);\n    }\n\n    // Búsqueda por texto\n    if (filters.search) {\n      query = query.or(`name.ilike.%${filters.search}%,description.ilike.%${filters.search}%`);\n    }\n\n    // Ordenamiento\n    if (filters.sortBy) {\n      switch (filters.sortBy) {\n        case 'precio-asc':\n          query = query.order('price', { ascending: true });\n          break;\n        case 'precio-desc':\n          query = query.order('price', { ascending: false });\n          break;\n        case 'nombre':\n          query = query.order('name', { ascending: true });\n          break;\n        case 'rating':\n          query = query.order('rating', { ascending: false });\n          break;\n        case 'ventas':\n          query = query.order('sales', { ascending: false });\n          break;\n        default:\n          query = query.order('created_at', { ascending: false });\n      }\n    } else {\n      query = query.order('created_at', { ascending: false });\n    }\n\n    const { data, error } = await query;\n\n    if (error) throw error;\n    return { data, error: null };\n  } catch (error) {\n    return { data: null, error: error.message };\n  }\n};\n\n// Obtener un producto por ID\nexport const getProductById = async (id) => {\n  try {\n    const { data, error } = await supabase\n      .from('products')\n      .select('*')\n      .eq('id', id)\n      .single();\n\n    if (error) throw error;\n    return { data, error: null };\n  } catch (error) {\n    return { data: null, error: error.message };\n  }\n};\n\n// Obtener productos por categoría\nexport const getProductsByCategory = async (category) => {\n  try {\n    const { data, error } = await supabase\n      .from('products')\n      .select('*')\n      .eq('category', category)\n      .eq('is_active', true)\n      .order('created_at', { ascending: false });\n\n    if (error) throw error;\n    return { data, error: null };\n  } catch (error) {\n    return { data: null, error: error.message };\n  }\n};\n\n// Buscar productos\nexport const searchProducts = async (searchTerm) => {\n  try {\n    const { data, error } = await supabase\n      .from('products')\n      .select('*')\n      .or(`name.ilike.%${searchTerm}%,description.ilike.%${searchTerm}%,category.ilike.%${searchTerm}%`)\n      .eq('is_active', true)\n      .limit(10);\n\n    if (error) throw error;\n    return { data, error: null };\n  } catch (error) {\n    return { data: null, error: error.message };\n  }\n};\n\n// Obtener productos destacados\nexport const getFeaturedProducts = async (limit = 4) => {\n  try {\n    const { data, error } = await supabase\n      .from('products')\n      .select('*')\n      .eq('is_active', true)\n      .order('rating', { ascending: false })\n      .limit(limit);\n\n    if (error) throw error;\n    return { data, error: null };\n  } catch (error) {\n    return { data: null, error: error.message };\n  }\n};\n\n// Obtener productos más vendidos\nexport const getBestSellers = async (limit = 4) => {\n  try {\n    const { data, error } = await supabase\n      .from('products')\n      .select('*')\n      .eq('is_active', true)\n      .order('sales', { ascending: false })\n      .limit(limit);\n\n    if (error) throw error;\n    return { data, error: null };\n  } catch (error) {\n    return { data: null, error: error.message };\n  }\n};\n\n// Actualizar stock de producto\nexport const updateProductStock = async (productId, quantity) => {\n  try {\n    const { data: product } = await getProductById(productId);\n    if (!product) throw new Error('Producto no encontrado');\n\n    const newStock = product.stock - quantity;\n    if (newStock < 0) throw new Error('Stock insuficiente');\n\n    const { data, error } = await supabase\n      .from('products')\n      .update({ stock: newStock })\n      .eq('id', productId)\n      .select()\n      .single();\n\n    if (error) throw error;\n    return { data, error: null };\n  } catch (error) {\n    return { data: null, error: error.message };\n  }\n};\n\n// Incrementar contador de ventas\nexport const incrementProductSales = async (productId, quantity = 1) => {\n  try {\n    const { data: product } = await getProductById(productId);\n    if (!product) throw new Error('Producto no encontrado');\n\n    const { data, error } = await supabase\n      .from('products')\n      .update({ sales: product.sales + quantity })\n      .eq('id', productId)\n      .select()\n      .single();\n\n    if (error) throw error;\n    return { data, error: null };\n  } catch (error) {\n    return { data: null, error: error.message };\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}